## T√≠tulo Conciso: Estrutura N√£o-Recombinante de √Årvores em Modelagem Financeira

```mermaid
flowchart LR
    A[In√≠cio: Raiz da √Årvore] --> B("N√≠vel 1: N√≥s distintos")
    B --> C1("N√≠vel 2: N√≥s distintos (sem uni√£o)")
    B --> C2("N√≠vel 2: N√≥s distintos (sem uni√£o)")
    C1 --> D1("N√≠vel 3: N√≥s distintos...")
    C1 --> D2("N√≠vel 3: N√≥s distintos...")
    C2 --> D3("N√≠vel 3: N√≥s distintos...")
    C2 --> D4("N√≠vel 3: N√≥s distintos...")
    D1 --> E1("...")
    D2 --> E2("...")
    D3 --> E3("...")
    D4 --> E4("...")
    style A fill:#f9f,stroke:#333,stroke-width:2px
    style B fill:#ccf,stroke:#333,stroke-width:2px
    style C1 fill:#ccf,stroke:#333,stroke-width:2px
    style C2 fill:#ccf,stroke:#333,stroke-width:2px
    style D1 fill:#ccf,stroke:#333,stroke-width:2px
    style D2 fill:#ccf,stroke:#333,stroke-width:2px
    style D3 fill:#ccf,stroke:#333,stroke-width:2px
    style D4 fill:#ccf,stroke:#333,stroke-width:2px
    
    subgraph "Estrutura N√£o-Recombinante"
        A
        B
        C1
        C2
        D1
        D2
        D3
        D4
        E1
        E2
        E3
        E4
    end
```

### Introdu√ß√£o

Em finan√ßas quantitativas, modelos de tempo discreto, como o modelo binomial ou multinomial, frequentemente utilizam a representa√ß√£o de um espa√ßo amostral atrav√©s de **√°rvores**, onde cada caminho da raiz at√© um n√≥ final representa uma trajet√≥ria poss√≠vel para um processo estoc√°stico. Uma **estrutura n√£o-recombinante** de √°rvore implica que os n√≥s em cada n√≠vel s√£o todos distintos e que eles n√£o se unem ao longo da √°rvore [^1]. Este cap√≠tulo explora a defini√ß√£o, as implica√ß√µes, e a import√¢ncia da estrutura n√£o-recombinante em modelos financeiros de tempo discreto.

### Conceitos Fundamentais

Em vez de utilizar listas ou tabelas, vamos apresentar os conceitos por meio de uma narrativa que explore suas propriedades.

**Conceito 1: Defini√ß√£o de Estrutura N√£o-Recombinante**

Em um modelo de tempo discreto, uma √°rvore √© dita ter uma **estrutura n√£o-recombinante** (non-recombining structure) se, a cada n√≠vel da √°rvore, os n√≥s que s√£o gerados a partir de diferentes n√≥s ancestrais s√£o sempre distintos e n√£o se unem, ou seja, se uma trajet√≥ria alcan√ßa um determinado n√≥, nenhuma outra trajet√≥ria chegar√° √†quele n√≥. Formalmente, isso significa que se dois n√≥s no n√≠vel k s√£o originados de diferentes n√≥s no n√≠vel k-1, ent√£o, esses dois n√≥s e os n√≥s que derivam deles at√© o tempo T s√£o √∫nicos e n√£o se unem em nenhuma etapa futura do modelo [^2].

*Explica√ß√£o Detalhada:*
  -  Em termos pr√°ticos, uma √°rvore n√£o recombinante indica que cada caminho tem uma hist√≥ria √∫nica, e n√£o h√° converg√™ncia entre os diferentes caminhos.
   -   Em termos matem√°ticos, a estrutura n√£o recombinante define explicitamente o espa√ßo amostral $\Omega$, onde cada trajet√≥ria do modelo √© um elemento √∫nico e distinto.
    -  A evolu√ß√£o do pre√ßo de um ativo n√£o depende dos resultados que levaram ao pre√ßo em um instante anterior, mas apenas do √∫ltimo valor que o ativo assume, o que √© uma propriedade de um processo de Markov, que √© fundamental nos modelos de tempo discreto utilizados em finan√ßas quantitativas.
    -  Modelos de tempo cont√≠nuo utilizam espa√ßos amostrais que n√£o s√£o recombinantes.

> ‚ö†Ô∏è **Nota Importante**:  A estrutura n√£o-recombinante de uma √°rvore implica que cada caminho √© √∫nico e que a informa√ß√£o sobre a evolu√ß√£o de um ativo seja preservada ao longo do tempo.

**Lemma 1:**  Em uma √°rvore n√£o-recombinante, o n√∫mero de n√≥s em um instante de tempo $k$  depende do n√∫mero de possibilidades a cada n√≥ no per√≠odo anterior. Se cada n√≥ tem $m$ filhos, ent√£o o n√∫mero de n√≥s no instante $k$ ser√° $m^k$, o que implica que o n√∫mero de n√≥s cresce exponencialmente com o tempo.

*Prova:* A demonstra√ß√£o segue da defini√ß√£o de estrutura n√£o-recombinante. Como os n√≥s n√£o se unem, ent√£o o n√∫mero de n√≥s √© igual ao produto do n√∫mero de n√≥s no n√≠vel anterior ($m$) pelo n√∫mero de n√≥s no nivel anterior. $\blacksquare$

> üí° **Exemplo Num√©rico: Crescimento de N√≥s em √Årvore N√£o-Recombinante**
>
> Considere uma √°rvore n√£o-recombinante onde cada n√≥ tem $m=3$ filhos.
> - No instante inicial ($k=0$), h√° 1 n√≥ (a raiz).
> - No instante $k=1$, h√° $3^1 = 3$ n√≥s.
> - No instante $k=2$, h√° $3^2 = 9$ n√≥s.
> - No instante $k=3$, h√° $3^3 = 27$ n√≥s.
>
> Este exemplo ilustra como o n√∫mero de n√≥s cresce exponencialmente com o tempo.
>
> Em contraste, em uma √°rvore recombinante, se tiv√©ssemos uma √°rvore com 3 possibilidades a cada instante de tempo, e com recombina√ß√£o dos n√≥s, ter√≠amos, no instante $k=3$, um n√∫mero de n√≥s igual a $1 + 3 + 3 + 3 = 10$, onde o n√∫mero de n√≥s cresce linearmente, e n√£o exponencialmente.

**Conceito 2: A Rela√ß√£o entre N√£o Recombina√ß√£o e œÉ-√Ålgebras**

Em modelos financeiros de tempo discreto, cada n√≥ da √°rvore representa um √°tomo de uma œÉ-√°lgebra $F_k$.  Em uma √°rvore n√£o recombinante, cada √°tomo de $F_k$ (que s√£o os subconjuntos menores do espa√ßo amostral) √© √∫nico e representa uma sequ√™ncia √∫nica de resultados [^3].  Em modelos de √°rvores n√£o recombinantes, a œÉ-√°lgebra $F_k$  √© constru√≠da de forma a que cada n√≥ no instante $k$ esteja em uma rela√ß√£o biun√≠voca com um √°tomo daquela œÉ-√°lgebra.
    -  A informa√ß√£o contida num √°tomo √© a trajet√≥ria seguida pelo processo desde o tempo inicial at√© o instante onde o √°tomo foi definido.
     -   A n√£o-recombina√ß√£o dos √°tomos garante que o fluxo da informa√ß√£o no modelo √© bem definido, sem ambiguidades ou perda de informa√ß√£o ao longo da sua evolu√ß√£o.

> ‚ùó **Ponto de Aten√ß√£o**:  A estrutura n√£o-recombinante define as menores unidades de informa√ß√£o do modelo (os √°tomos) de forma que a informa√ß√£o sobre o caminho que leva a cada resultado √© preservada.

**Corol√°rio 1:**  Em modelos com √°rvores n√£o recombinantes, a œÉ-√°lgebra gerada por todos os √°tomos de cada instante de tempo $k$ ($F_k$) cont√©m todas as informa√ß√µes sobre os valores do processo e tamb√©m sobre o caminho que leva a esse valor.
*Prova:*   A demonstra√ß√£o segue da defini√ß√£o de œÉ-√°lgebra gerada, que garante que todos os resultados em um instante k sejam medidos por $F_k$, e da defini√ß√£o de √°tomos, que representam as menores unidades de informa√ß√£o.  $\blacksquare$

> üí° **Exemplo Num√©rico: œÉ-√Ålgebra em √Årvore N√£o-Recombinante**
>
> Considere uma √°rvore n√£o-recombinante com 2 n√≠veis e 2 filhos por n√≥ (base 2).
>
> - No tempo $k=0$, temos a raiz, que corresponde a um √°tomo da œÉ-√°lgebra $F_0$.
> - No tempo $k=1$, temos 2 n√≥s (√°tomos de $F_1$). Cada n√≥ representa um caminho √∫nico (ex: "subiu", "desceu").
> - No tempo $k=2$, temos 4 n√≥s (√°tomos de $F_2$). Cada n√≥ representa uma sequ√™ncia √∫nica de dois passos (ex: "subiu-subiu", "subiu-desceu", "desceu-subiu", "desceu-desceu").
>
> Cada √°tomo (n√≥) em $F_2$ √© √∫nico, refletindo a n√£o-recombina√ß√£o e preservando a informa√ß√£o sobre a trajet√≥ria do processo. A œÉ-√°lgebra $F_2$ cont√©m todos os subconjuntos poss√≠veis desses 4 √°tomos.

**Conceito 3:  A Modelagem da Informa√ß√£o em √Årvores N√£o Recombinantes**

Em modelos financeiros de tempo discreto, a escolha da estrutura da √°rvore (recombinante ou n√£o recombinante) define o n√≠vel de detalhe e o tipo de informa√ß√£o que √© capturada no modelo. Em modelos com √°rvores n√£o recombinantes, √© poss√≠vel seguir o rastro da informa√ß√£o atrav√©s do mapeamento entre n√≥s (que representam valores do pre√ßo do ativo), √°tomos da œÉ-√°lgebra e o valor das vari√°veis aleat√≥rias que definem o modelo.
    -  A estrutura n√£o recombinante de √°rvores possibilita a modelagem de estrat√©gias de investimento onde o hist√≥rico do ativo at√© o momento de tomada de decis√£o √© relevante.
  -   Modelos com √°rvores n√£o recombinantes s√£o utilizados em situa√ß√µes onde o caminho do ativo tem um impacto na precifica√ß√£o de derivativos, e em estrat√©gias de trading que utilizem informa√ß√£o espec√≠fica do hist√≥rico dos pre√ßos.

> ‚úîÔ∏è **Destaque**: A estrutura n√£o-recombinante de √°rvores permite a modelagem precisa do fluxo de informa√ß√µes e da evolu√ß√£o do estado dos ativos, mantendo a trajet√≥ria de cada processo.

### O Uso da Estrutura N√£o Recombinante na Modelagem Financeira

```mermaid
flowchart LR
    A["Raiz da √Årvore (S0)"] --> B("Processo Estoc√°stico (Sk)")
    B --> C("√Årvore N√£o Recombinante")
    C --> D("Filtra√ß√£o (Fk)")
    D --> E("Estrat√©gias de Trading")
    D --> F("Precifica√ß√£o de Derivativos")
    style A fill:#f9f,stroke:#333,stroke-width:2px
    style B fill:#ccf,stroke:#333,stroke-width:2px
    style C fill:#ccf,stroke:#333,stroke-width:2px
    style D fill:#ccf,stroke:#333,stroke-width:2px
    style E fill:#ccf,stroke:#333,stroke-width:2px
    style F fill:#ccf,stroke:#333,stroke-width:2px
    
    subgraph "Fluxo da Modelagem Financeira"
    A
    B
    C
    D
    E
    F
    end
```

**Aplica√ß√µes em Modelos de Pre√ßos de Ativos**

Modelos com estrutura n√£o recombinante s√£o utilizados para modelar a evolu√ß√£o de pre√ßos de ativos em tempo discreto quando a ordem dos eventos √© importante para os resultados e para o c√°lculo das probabilidades.
     -  Modelos que modelam a volatilidade como um processo separado podem utilizar √°rvores n√£o recombinantes, onde cada caminho representa uma evolu√ß√£o poss√≠vel do pre√ßo do ativo e da volatilidade simultaneamente.
    -  Modelos onde as decis√µes de um participante do mercado (ou seja, modelos de microestrutura) influenciam os pre√ßos utilizam √°rvores onde cada trajet√≥ria representa tamb√©m as decis√µes do participante do mercado e o fluxo de ordens.
     -  A modelagem de modelos com depend√™ncia temporal e com revers√£o √† m√©dia de pre√ßos tamb√©m pode utilizar a representa√ß√£o por meio de √°rvores n√£o recombinantes.

**Lemma 2:**  A representa√ß√£o do espa√ßo amostral como um conjunto de trajet√≥rias (√°rvore n√£o recombinante) preserva a informa√ß√£o sobre a sequ√™ncia temporal dos eventos, o que √© fundamental para a constru√ß√£o de modelos de pre√ßos consistentes com a propriedade da causalidade entre as vari√°veis do modelo, onde os valores futuros dependem apenas dos valores passados.

*Prova:*   A propriedade segue diretamente da defini√ß√£o de √°rvores n√£o recombinantes, onde os n√≥s n√£o convergem e que portanto, a trajet√≥ria de cada n√≥ √© √∫nica e individual.   $\blacksquare$

> üí° **Exemplo Num√©rico: Modelagem de Volatilidade Estoc√°stica**
>
> Suponha que o pre√ßo de um ativo ($S_t$) e sua volatilidade ($\sigma_t$) evoluam em tempo discreto. Em um modelo com √°rvore n√£o-recombinante, cada n√≥ representa um par $(S_t, \sigma_t)$. Por exemplo:
>
> - No tempo inicial ($t=0$): $(S_0, \sigma_0) = (100, 0.2)$.
> - No tempo $t=1$, o pre√ßo pode subir ou descer, e a volatilidade pode aumentar ou diminuir:
>     - N√≥ 1: $(S_1, \sigma_1) = (105, 0.22)$
>     - N√≥ 2: $(S_1, \sigma_1) = (98, 0.18)$
>     - N√≥ 3: $(S_1, \sigma_1) = (102, 0.21)$
>     - N√≥ 4: $(S_1, \sigma_1) = (95, 0.19)$
>
> Cada n√≥ no tempo $t=1$ tem um hist√≥rico √∫nico do par $(S, \sigma)$, e a √°rvore n√£o recombinante preserva essa informa√ß√£o para os per√≠odos seguintes. Isso permite modelar a depend√™ncia entre o pre√ßo e a volatilidade, o que √© uma caracter√≠stica fundamental de modelos de volatilidade estoc√°stica.

**Aplica√ß√µes na Modelagem de Derivativos**

Modelos que utilizam √°rvores n√£o recombinantes s√£o mais flex√≠veis na representa√ß√£o das trajet√≥rias dos pre√ßos de ativos, o que √© fundamental para a modelagem de alguns derivativos financeiros, como op√ß√µes com *path dependence* (onde o valor do payoff depende da trajet√≥ria do pre√ßo e n√£o apenas do pre√ßo no instante final do contrato).
    - Op√ß√µes Asi√°ticas,  por exemplo, pagam uma fun√ß√£o da m√©dia dos pre√ßos durante um determinado per√≠odo de tempo, o que imp√µe que toda a trajet√≥ria do pre√ßo seja mantida.
    - Op√ß√µes com barreiras e op√ß√µes com *lookback* tamb√©m dependem da trajet√≥ria do pre√ßo para a sua precifica√ß√£o.
  - A utiliza√ß√£o de √°rvores n√£o recombinantes permite um estudo mais detalhado de como a din√¢mica de pre√ßos ao longo do tempo afeta o pre√ßo dos derivativos, o que torna a modelagem do mercado mais realista e consistente com a sua din√¢mica, mesmo quando as suas propriedades (como a de ser um martingale) s√£o modeladas sob uma medida de probabilidade artificial.

**Lemma 3:** A modelagem de derivativos com payoff que depende da trajet√≥ria do pre√ßo de um ativo exige a utiliza√ß√£o de uma estrutura n√£o recombinante, pois a informa√ß√£o de cada instante do tempo (e n√£o apenas o pre√ßo no instante final) √© necess√°ria para o c√°lculo do payoff.

*Prova:*   A propriedade segue da defini√ß√£o de derivativos com *path dependence*, e da necessidade de se conhecer todo o caminho do processo estoc√°stico para a determina√ß√£o do payoff, o que exige uma √°rvore com todos os n√≥s separados (n√£o recombinante). $\blacksquare$

> üí° **Exemplo Num√©rico: Precifica√ß√£o de Op√ß√£o Asi√°tica**
>
> Uma op√ß√£o asi√°tica paga o valor da diferen√ßa entre a m√©dia dos pre√ßos do ativo durante um per√≠odo e o pre√ßo de exerc√≠cio (strike). Para precificar essa op√ß√£o usando uma √°rvore, √© essencial que cada caminho na √°rvore mantenha o hist√≥rico de pre√ßos.
>
> Considere um ativo com pre√ßo inicial $S_0 = 100$ e uma op√ß√£o asi√°tica com pre√ßo de exerc√≠cio $K = 100$, com m√©dia aritm√©tica dos pre√ßos em $T=3$. Suponha que a √°rvore seja n√£o-recombinante, com dois poss√≠veis resultados a cada instante de tempo (para cima ou para baixo).
>
> - **Caminho 1:** Sobe-Sobe-Sobe: Pre√ßos $S_1 = 110$, $S_2 = 121$, $S_3 = 133.1$. M√©dia: $(100+110+121+133.1)/4 = 116.025$. Payoff: $max(116.025-100, 0) = 16.025$
> - **Caminho 2:** Sobe-Sobe-Desce: Pre√ßos $S_1 = 110$, $S_2 = 121$, $S_3 = 108.9$. M√©dia: $(100+110+121+108.9)/4 = 110$. Payoff: $max(110-100, 0) = 10$
> - **Caminho 3:** Sobe-Desce-Sobe: Pre√ßos $S_1 = 110$, $S_2 = 99$, $S_3 = 108.9$. M√©dia: $(100+110+99+108.9)/4 = 104.475$. Payoff: $max(104.475-100, 0) = 4.475$
> - **Caminho 4:** Sobe-Desce-Desce: Pre√ßos $S_1 = 110$, $S_2 = 99$, $S_3 = 89.1$. M√©dia: $(100+110+99+89.1)/4 = 99.775$. Payoff: $max(99.775-100, 0) = 0$
>
> E assim por diante.  Para calcular o pre√ßo da op√ß√£o, √© necess√°rio calcular o payoff de cada um dos 8 caminhos poss√≠veis na √°rvore, e calcular o valor presente do payoff m√©dio, usando uma medida de probabilidade neutra ao risco.
>
> Uma √°rvore n√£o-recombinante garante que o hist√≥rico de pre√ßos de cada caminho seja preservado para calcular a m√©dia e o payoff corretos.

### Deriva√ß√µes Te√≥ricas Avan√ßadas

#### Se√ß√£o Te√≥rica Avan√ßada 1:  Como a Escolha da Base das √Årvores Afeta a Modelagem de Derivativos?

Modelos financeiros de tempo discreto utilizam √°rvores para modelar as trajet√≥rias dos ativos.  O modelo binomial, por exemplo, tem uma base 2 (dois resultados para cada per√≠odo).  Como a escolha da base da √°rvore (o n√∫mero de filhos de cada n√≥) afeta a modelagem e o tratamento matem√°tico de derivativos e outros instrumentos financeiros?

*Explica√ß√£o Detalhada:*
   -  Em modelos com √°rvores que tem uma base diferente de 2, o n√∫mero de resultados poss√≠veis para a evolu√ß√£o do ativo no tempo, a cada instante de tempo, pode variar.  Modelos com um n√∫mero grande de possibilidades s√£o √∫teis para aproximar modelos de tempo cont√≠nuo, onde a evolu√ß√£o de pre√ßos √© modelada como sendo ‚Äúsuave‚Äù.
   -   A escolha de uma base com um n√∫mero maior de poss√≠veis resultados a cada instante de tempo permite a modelagem mais precisa do comportamento dos ativos, mas tamb√©m torna o modelo mais complexo de ser analisado, pois a estrutura do espa√ßo de trajet√≥rias, e o n√∫mero de √°tomos, aumenta exponencialmente.
   -   A defini√ß√£o de modelos com um n√∫mero arbitr√°rio de op√ß√µes de varia√ß√£o do ativo (modelos multinomiais) √© fundamental para modelos com volatilidade estoc√°stica, onde os ativos tem a possibilidade de terem uma variedade grande de comportamentos ao longo do tempo.

**Lemma 4:** Modelos com √°rvores que t√™m uma base $m$ (ou seja, onde cada n√≥ pode se dividir em m n√≥s),  o n√∫mero de n√≥s no instante k √© igual a $m^k$.  Se o valor de m tende a infinito, ent√£o o n√∫mero de n√≥s passa a ser n√£o enumer√°vel, e o modelo se torna mais adequado para descrever a evolu√ß√£o do pre√ßo de um ativo em tempo cont√≠nuo.

*Prova:* A demonstra√ß√£o √© feita atrav√©s da constru√ß√£o de uma √°rvore, que se ramifica por m a cada instante de tempo, e do c√°lculo de como o n√∫mero de n√≥s cresce com o tempo.  $\blacksquare$

> üí° **Exemplo Num√©rico: Compara√ß√£o de Bases em √Årvores**
>
> Vamos comparar √°rvores com bases diferentes para ilustrar o Lemma 4:
>
> - **Base 2 (Binomial):** Em $k=3$, temos $2^3 = 8$ n√≥s.
> - **Base 3 (Trinomial):** Em $k=3$, temos $3^3 = 27$ n√≥s.
> - **Base 4:** Em $k=3$, temos $4^3 = 64$ n√≥s.
>
> Quanto maior a base, mais caminhos e n√≥s s√£o gerados para o mesmo horizonte de tempo. Uma base maior oferece maior flexibilidade para modelar o movimento do pre√ßo do ativo, mas aumenta a complexidade computacional.

**Corol√°rio 4:**   A escolha de uma base maior nas √°rvores permite modelos mais ricos e realistas, mas tamb√©m introduz uma complexidade matem√°tica e computacional que deve ser levada em considera√ß√£o na constru√ß√£o de um modelo.

#### Se√ß√£o Te√≥rica Avan√ßada 2:  Como o Conceito de Martingale √© Afetado pela N√£o-Recombina√ß√£o da √Årvore?

A propriedade de martingale √© fundamental para precifica√ß√£o livre de arbitragem. Como a estrutura n√£o-recombinante de √°rvores afeta o conceito de martingale na defini√ß√£o de um processo?

*Explica√ß√£o Detalhada:*
    -  Em modelos onde a √°rvore √© recombinante, o n√∫mero de n√≥s cresce de forma linear ao longo do tempo, mas em modelos onde a √°rvore √© n√£o recombinante, o n√∫mero de n√≥s cresce de forma exponencial com o tempo, e portanto √© mais dif√≠cil garantir que a propriedade de martingale seja mantida.
   -  Uma √°rvore n√£o-recombinante √© uma ferramenta adequada para representar o comportamento de pre√ßos que dependem fortemente da sua trajet√≥ria passada, e a propriedade de martingale, em geral, n√£o se mant√©m quando se considera todo o espa√ßo de trajet√≥rias, mas pode ser modelada como uma local martingale em modelos mais complexos.
  -  Modelos com √°rvores n√£o recombinantes, podem ser utilizados para modelar a influ√™ncia da hist√≥ria de pre√ßos nos valores dos ativos e derivativos e para modelar situa√ß√µes onde a decis√£o de parar um processo (e, portanto, modelar um tempo de parada) √© relevante.
   - Em geral, a hip√≥tese de que o processo seja um martingale se relaciona com a escolha de um ativo de refer√™ncia, e portanto a modelagem de mercados com m√∫ltiplos ativos de refer√™ncia torna a modelagem do portf√≥lio mais complexa.

**Lemma 5:** Em modelos de √°rvores n√£o recombinantes, o processo de pre√ßo descontado que √© um martingale tem um n√∫mero muito maior de vari√°veis a serem levadas em considera√ß√£o, do que em modelos com √°rvores recombinantes, pois a dimens√£o da œÉ-√°lgebra √© maior.

*Prova:* A demonstra√ß√£o segue da defini√ß√£o de processo martingale e da defini√ß√£o de œÉ-√°lgebra gerada por uma √°rvore n√£o recombinante.  $\blacksquare$

> üí° **Exemplo Num√©rico: Martingale em √Årvore N√£o-Recombinante**
>
> Considere um ativo com pre√ßo inicial $S_0 = 100$. Em uma √°rvore n√£o-recombinante com 2 n√≠veis, temos:
>
> - **N√≠vel 1:**
>     - N√≥ 1: $S_1 = 110$
>     - N√≥ 2: $S_1 = 95$
> - **N√≠vel 2:**
>      - N√≥ 1 (Sobe-Sobe): $S_2 = 120$
>      - N√≥ 2 (Sobe-Desce): $S_2 = 105$
>      - N√≥ 3 (Desce-Sobe): $S_2 = 100$
>      - N√≥ 4 (Desce-Desce): $S_2 = 90$
>
> Para que o pre√ßo descontado seja um martingale (sob uma medida neutra ao risco), o valor esperado do pre√ßo futuro descontado deve ser igual ao pre√ßo presente.  Em uma √°rvore n√£o-recombinante, cada caminho √© √∫nico, e a probabilidade associada a cada caminho √© calculada de forma a garantir que o processo seja um martingale.
>
> Por exemplo, se a taxa livre de risco for zero, uma poss√≠vel configura√ß√£o de probabilidades neutras ao risco seria:
>
> - P(Sobe-Sobe) = 0.25
> - P(Sobe-Desce) = 0.25
> - P(Desce-Sobe) = 0.25
> - P(Desce-Desce) = 0.25
>
>  Nesse caso, o valor esperado de $S_2$ √© $0.25 * (120 + 105 + 100 + 90) = 103.75$, que n√£o √© o valor inicial descontado.  Para que seja um martingale, a probabilidade de cada caminho deve ser recalculada, levando em conta a n√£o recombina√ß√£o da √°rvore.
>
> Em uma √°rvore recombinante, o c√°lculo das probabilidades neutras ao risco √© mais simples, pois a informa√ß√£o da trajet√≥ria √© menos relevante para o c√°lculo do valor esperado.

**Corol√°rio 5:**   A escolha de utilizar uma √°rvore recombinante ou n√£o recombinante na modelagem de ativos e derivativos tem um impacto direto na complexidade matem√°tica do modelo, mas tamb√©m reflete diferentes formas de modelar a din√¢mica do mercado, e a sua escolha deve ser feita levando em considera√ß√£o o tipo de problema que se busca modelar.

#### Se√ß√£o Te√≥rica Avan√ßada 3:  Como a Estrutura N√£o-Recombinante de √Årvores Afeta a Modelagem de Custos de Transa√ß√£o?

A modelagem da presen√ßa de custos de transa√ß√£o no mercado √© fundamental para tornar a modelagem financeira mais realista. Como a estrutura n√£o-recombinante das √°rvores se relaciona com a modelagem de custos de transa√ß√£o?

*Explica√ß√£o Detalhada:*
    -  A propriedade de recombina√ß√£o nas √°rvores simplifica a modelagem, pois modelos onde as trajet√≥rias convergem representam situa√ß√µes onde o pre√ßo do ativo no instante presente √© independente da trajet√≥ria passada.
  -  A modelagem de √°rvores n√£o recombinantes permite que o custo de transa√ß√£o dependa explicitamente da trajet√≥ria do ativo at√© o momento da transa√ß√£o, modelando, por exemplo, o custo de compra e venda de um ativo em fun√ß√£o de sua volatilidade e liquidez.
    -   Em modelos com custos de transa√ß√£o que s√£o dependentes da trajet√≥ria do ativo, a estrutura n√£o recombinante permite capturar um modelo de custos que seja mais consistente com o comportamento do mercado.
    -    A modelagem de custos de transa√ß√£o em modelos de √°rvores n√£o recombinantes leva a modelos onde o ganho do portf√≥lio j√° n√£o √© um martingale, e a sua modelagem necessita de ferramentas e propriedades diferentes das martingales.
   -  A modelagem de mercados com fric√ß√£o tamb√©m exige uma modelagem mais sofisticada do conceito de autofinanciamento, uma vez que a estrat√©gia passa a ter um componente de custo que n√£o √© desprez√≠vel e que depende da trajet√≥ria dos pre√ßos dos ativos.

**Lemma 6:**  Em modelos com custos de transa√ß√£o que dependem da trajet√≥ria do processo, as √°rvores n√£o recombinantes se tornam necess√°rias para a representa√ß√£o da informa√ß√£o e para o c√°lculo das propriedades de um portf√≥lio, dado que a cada n√≥ da √°rvore √© necess√°rio representar tanto o valor do ativo quanto a trajet√≥ria que levou ao pre√ßo naquele instante.

*Prova:*  A prova segue da defini√ß√£o de custo de transa√ß√£o e de √°rvores n√£o recombinantes. Se o custo depende da trajet√≥ria, e n√£o apenas do n√≥ onde o ativo se encontra, ent√£o, a modelagem necessita da √°rvore n√£o recombinante para modelar a influ√™ncia do passado nos custos de trading. $\blacksquare$

> üí° **Exemplo Num√©rico: Custos de Transa√ß√£o Dependentes da Trajet√≥ria**
>
> Suponha que o custo de transa√ß√£o para comprar ou vender um ativo dependa da volatilidade observada nos √∫ltimos 2 per√≠odos. Em uma √°rvore n√£o-recombinante, podemos modelar essa depend√™ncia.
>
> - **Cen√°rio:**
>     - Pre√ßo inicial $S_0 = 100$
>     - Custo de transa√ß√£o base: 0.1% do valor da transa√ß√£o
>     - Custo adicional: 0.05% do valor da transa√ß√£o para cada movimento de alta ou baixa nos √∫ltimos 2 per√≠odos.
>
> - **√Årvore:**
>     - **N√≠vel 1:**
>         - N√≥ 1 (Sobe): $S_1 = 105$. Custo inicial: 0.1%
>         - N√≥ 2 (Desce): $S_1 = 95$. Custo inicial: 0.1%
>     - **N√≠vel 2:**
>         - N√≥ 1 (Sobe-Sobe): $S_2 = 110.25$. Custo: 0.1% + 0.05% (1 movimento) = 0.15%
>         - N√≥ 2 (Sobe-Desce): $S_2 = 100$. Custo: 0.1% + 0.05% (2 movimentos) = 0.2%
>         - N√≥ 3 (Desce-Sobe): $S_2 = 100$. Custo: 0.1% + 0.05% (2 movimentos) = 0.2%
>         - N√≥ 4 (Desce-Desce): $S_2 = 90.25$. Custo: 0.1% + 0.05% (1 movimento) = 0.15%
>
> Em uma √°rvore recombinante, n√£o seria poss√≠vel rastrear os movimentos de alta e baixa separadamente, e o custo de transa√ß√£o seria modelado de forma mais simples, o que n√£o refletiria a depend√™ncia temporal dos custos.
>
> Em uma √°rvore n√£o recombinante, o custo de transa√ß√£o pode ser modelado de forma mais precisa, dependendo da trajet√≥ria de pre√ßos.

**Corol√°rio 6:** A utiliza√ß√£o de √°rvores n√£o recombinantes √© um componente fundamental da modelagem de mercados com custos de transa√ß√£o, dado que ela permite a modelagem da depend√™ncia entre a trajet√≥ria dos ativos e a evolu√ß√£o das carteiras de investimento, o que leva a modelos que capturam de forma mais realista o comportamento do mercado.

### Conclus√£o

A estrutura n√£o-recombinante de √°rvores √© um elemento essencial para a modelagem de processos estoc√°sticos em finan√ßas quantitativas de tempo discreto, onde a informa√ß√£o sobre a trajet√≥ria dos ativos √© importante. A sua utiliza√ß√£o, em modelos com n√∫mero finito ou infinito de instantes de tempo e resultados, √© fundamental para a constru√ß√£o de modelos consistentes, e onde os resultados obtidos sejam v√°lidos com respeito √†s suas defini√ß√µes e hip√≥teses.  As se√ß√µes te√≥ricas avan√ßadas mostraram como a cardinalidade do espa√ßo de trajet√≥rias, a rela√ß√£o com a propriedade de martingale e o impacto da modelagem de custos de transa√ß√£o impactam a escolha de √°rvores recombinantes e n√£o recombinantes em modelos financeiros, demonstrando a relev√¢ncia deste conceito no desenvolvimento de modelos mais realistas.

### Refer√™ncias
[^1]: "Em finan√ßas quantitativas, modelos de tempo discreto, como o modelo binomial ou multinomial, frequentemente utilizam a representa√ß√£o de um espa√ßo amostral atrav√©s de **√°rvores**, onde cada caminho da raiz at√© um n√≥ final representa uma trajet√≥ria poss√≠vel para um processo estoc√°stico."

[^2]: "Em um modelo de tempo discreto, uma √°rvore √© dita ter uma **estrutura n√£o-recombinante** (non-recombining structure) se, a cada n√≠vel da √°rvore..."
[^3]: "Para qualquer espa√ßo amostral $\Omega$, sempre podemos definir pelo menos duas œÉ-√°lgebras triviais..."
[^4]: "Em modelos financeiros, a sequ√™ncia de pre√ßos de um ativo $(S_k)_{k=0,1,\ldots,T}$ √© um exemplo t√≠pico de processo adaptado."
[^5]: "Em modelos financeiros, a taxa de juros $r_k$ √© geralmente considerada predict√≠vel, ou seja, $r_k$ √© mensur√°vel em rela√ß√£o √† œÉ-√°lgebra $F_{k-1}$."

[^6]: "A **medida de probabilidade** ($P$) √© uma fun√ß√£o que atribui um n√∫mero entre 0 e 1 a cada evento em $F$..."
[^7]: "No contexto de modelos financeiros em tempo discreto, o processo de ganhos de uma estrat√©gia auto-financiada √© uma martingale em rela√ß√£o a uma medida de martingale equivalente $Q$..."

[^8]: "Informa√ß√£o cr√≠tica que merece destaque."
[^9]: "Observa√ß√£o crucial para compreens√£o te√≥rica correta."
[^10]: "Informa√ß√£o t√©cnica ou te√≥rica com impacto significativo."
[^11]: "Em modelos financeiros, o conceito de adaptabilidade √© fundamental. Um processo estoc√°stico $X$ √© considerado adaptado se $X_k$ √© $F_k$-mensur√°vel para cada $k$."
[^12]:  "A escolha da filtra√ß√£o afeta a defini√ß√£o de conceitos como martingales e predictibilidade."
[^13]: "Apresente um corol√°rio que resulte diretamente do Lemma 2, conforme indicado no contexto."
[^14]: "Em mercados com informa√ß√£o assim√©trica, estrat√©gias de trading s√£o modeladas utilizando processos estoc√°sticos adaptados √† filtra√ß√£o do agente correspondente. Um *insider* pode utilizar informa√ß√µes n√£o dispon√≠veis aos outros agentes, o que pode implicar em modelos e resultados distintos."
